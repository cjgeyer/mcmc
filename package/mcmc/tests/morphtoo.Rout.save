
R version 3.1.0 (2014-04-10) -- "Spring Dance"
Copyright (C) 2014 The R Foundation for Statistical Computing
Platform: x86_64-unknown-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> 
>  library(mcmc)
Loading required package: rcdd
If you want correct answers, use rational arithmetic.
See the Warnings sections added to help pages for
    functions that do computational geometry.

> 
>  x <- seq(0, 10, length = 10001)
> 
>  ### sub-exponentially light transformation
> 
>  b <- 0.5
>  fsub <- morph(b = b)
> 
>  y <- unlist(Map(fsub$inverse, x))
> 
>  myfsub <- function(x) ifelse(x > 1 / b, exp(b * x) - exp(1) / 3,
+      (x * b)^3 * exp(1) / 6 + x * b * exp(1) / 2)
>  y2 <- myfsub(x)
>  all.equal(y, y2, tolerance = 1e-14)
[1] TRUE
> 
>  z <- unlist(Map(fsub$transform, y))
>  all.equal(z, x, tolerance = 1e-14)
[1] TRUE
> 
>  ### exponentially light transformation
> 
>  r <- 5 
>  p <- 3
>  fp3 <- morph(r = r)
> 
>  y <- unlist(Map(fp3$inverse, x))
> 
>  myfp3 <- function(x) ifelse(x < r, x, x + (x - r)^p)
>  y2 <- myfp3(x)
>  all.equal(y, y2, tolerance = 1e-14)
[1] TRUE
> 
>  z <- unlist(Map(fp3$transform, y))
>  all.equal(z, x, tolerance = 1e-12)
[1] TRUE
> 
>  ### both together
> 
>  fboth <- morph(b = b, r = r)
> 
>  y <- unlist(Map(fboth$inverse, x))
>  y2 <- myfsub(myfp3(x))
>  all.equal(y, y2, tolerance = 1e-14)
[1] TRUE
> 
>  z <- unlist(Map(fboth$transform, y))
>  all.equal(z, x, tolerance = 1e-12)
[1] TRUE
> 
>  ### exponentially light transformation with p != 3
> 
>  r <- 5 
>  p <- 2.2
>  fpo <- morph(r = r, p = p)
> 
>  y <- unlist(Map(fpo$inverse, x))
> 
>  myfpo <- function(x) ifelse(x < r, x, x + (x - r)^p)
>  y2 <- myfpo(x)
>  all.equal(y, y2, tolerance = 1e-14)
[1] TRUE
> 
>  z <- unlist(Map(fpo$transform, y))
>  all.equal(z, x, tolerance = 1e-14)
[1] TRUE
> 
> 
> proc.time()
   user  system elapsed 
  0.886   0.026   0.941 
